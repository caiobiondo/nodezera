const database = require ('../../services/database');

const baseQuery =

`SELECT 'PARAMETROS' TABELA, SYSDATE OPERACAO, 
PARAMETROS.IDS_PARAMETROS ,
PARAMETROS.DIASEXCECAOPROPOSTA ,
PARAMETROS.DIASLOOKUPPROPOSTA ,
PARAMETROS.FLAG_BLKPFFIXO ,
PARAMETROS.FLAG_BLKPFMOVEL ,
PARAMETROS.FLAG_BLKPJFIXO ,
PARAMETROS.FLAG_BLKPJMOVEL ,
PARAMETROS.FLAG_WLPF ,
PARAMETROS.FLAG_WLPFFIXO ,
PARAMETROS.FLAG_WLPFMOVEL ,
PARAMETROS.FLAG_WLPJFIXO ,
PARAMETROS.FLAG_WLPJMOVEL ,
PARAMETROS.FLAGBASEINTERNA ,
PARAMETROS.MAXIMOPRODUTOSDA ,
PARAMETROS.SYS_CREATEDATE ,
PARAMETROS.EMPRESAS_FATORMULTIPLOFATURAME ,
PARAMETROS.EMPRESAS_QTDEMAXIMADIASFATURAA ,
PARAMETROS.EMPRESAS_VALORMAXIMOMULTIPLOFA ,
PARAMETROS.MASSIVO_FATORMULTIPLOFATURAMEN ,
PARAMETROS.MASSIVO_QTDEMAXIMADIASFATURAAT ,
PARAMETROS.MASSIVO_VALORMAXIMOMULTIPLOFAT ,
PARAMETROS.MISSING_FATORMULTIPLOFATURAMEN ,
PARAMETROS.MISSING_QTDEMAXIMADIASFATURAAT ,
PARAMETROS.MISSING_VALORMAXIMOMULTIPLOFAT ,
PARAMETROS.TOP_FATORMULTIPLOFATURAMENTO ,
PARAMETROS.TOP_QTDEMAXIMADIASFATURAATRASO ,
PARAMETROS.TOP_VALORMAXIMOMULTIPLOFATURAM ,
PARAMETROS.ALCADAPADRAO_QTDFISICOVOZDADOS ,
PARAMETROS.ALCADAPADRAO_QTDM2M ,
PARAMETROS.ALCADAPADRAO_VALORATE ,
PARAMETROS.ALCADAPADRAO_VALORDE ,
PARAMETROS.COORDENACAOACC_QTDFISICOVOZDAD ,
PARAMETROS.COORDENACAOACC_QTDM2M ,
PARAMETROS.COORDENACAOACC_VALORATE ,
PARAMETROS.COORDENACAOACC_VALORDE ,
PARAMETROS.COORDENACAOTEF_QTDFISICOVOZDAD ,
PARAMETROS.COORDENACAOTEF_QTDM2M ,
PARAMETROS.COORDENACAOTEF_VALORATE ,
PARAMETROS.COORDENACAOTEF_VALORDE ,
PARAMETROS.DIASEXPIRACAOREPROVACAO ,
PARAMETROS.DIRETOREXECVPTEF_QTDFISICOVOZD ,
PARAMETROS.DIRETOREXECVPTEF_QTDM2M ,
PARAMETROS.DIRETOREXECVPTEF_VALORATE ,
PARAMETROS.DIRETOREXECVPTEF_VALORDE ,
PARAMETROS.DIRETORTEF_QTDFISICOVOZDADOS ,
PARAMETROS.DIRETORTEF_QTDM2M ,
PARAMETROS.DIRETORTEF_VALORATE ,
PARAMETROS.DIRETORTEF_VALORDE ,
PARAMETROS.GERENTEACC_QTDFISICOVOZDADOS ,
PARAMETROS.GERENTEACC_QTDM2M ,
PARAMETROS.GERENTEACC_VALORATE ,
PARAMETROS.GERENTEACC_VALORDE ,
PARAMETROS.GERENTEDIVISAOTEF_QTDFISICOVOZ ,
PARAMETROS.GERENTEDIVISAOTEF_QTDM2M ,
PARAMETROS.GERENTEDIVISAOTEF_VALORATE ,
PARAMETROS.GERENTEDIVISAOTEF_VALORDE ,
PARAMETROS.GERENTESECAOTEF_QTDFISICOVOZDA ,
PARAMETROS.GERENTESECAOTEF_QTDM2M ,
PARAMETROS.GERENTESECAOTEF_VALORATE ,
PARAMETROS.GERENTESECAOTEF_VALORDE ,
PARAMETROS.PERCMAXSOBCAPITALSOCIAL ,
PARAMETROS.PERIODOMAXFUNDACAO ,
PARAMETROS.QTDMAXACOESJUDICIAIS ,
PARAMETROS.QTDMAXACOESJUDICIAISSOCIOS ,
PARAMETROS.QTDREENVIOCOTACOESGN ,
PARAMETROS.QTDREENVIOCOTACOESMESA ,
PARAMETROS.QTDREPROVADONEGADO ,
PARAMETROS.VLRMAXACOESJUDICIAIS ,
PARAMETROS.VLRMAXACOESJUDICIAISSOCIOS ,
PARAMETROS.ALCADAPADRAO_QTDFISICOVOZDA002 ,
PARAMETROS.ALCADAPADRAO_QTDFISICOVOZDA001 ,
PARAMETROS.ALCADAPADRAO_QTDM2MATE ,
PARAMETROS.COORDENACAOACC_QTDFISICOVOZ002 ,
PARAMETROS.COORDENACAOACC_QTDFISICOVOZ001 ,
PARAMETROS.COORDENACAOACC_QTDM2MATE ,
PARAMETROS.COORDENACAOTEF_QTDFISICOVOZ002 ,
PARAMETROS.COORDENACAOTEF_QTDFISICOVOZ001 ,
PARAMETROS.COORDENACAOTEF_QTDM2MATE ,
PARAMETROS.DIRETOREXECVPTEF_QTDFISICOV002 ,
PARAMETROS.DIRETOREXECVPTEF_QTDFISICOV001 ,
PARAMETROS.DIRETOREXECVPTEF_QTDM2MATE ,
PARAMETROS.DIRETORTEF_QTDFISICOVOZDADOSAT ,
PARAMETROS.DIRETORTEF_QTDM2MATE ,
PARAMETROS.GERENTEACC_QTDFISICOVOZDADOSAT ,
PARAMETROS.GERENTEACC_QTDM2MATE ,
PARAMETROS.GERENTEDIVISAOTEF_QTDFISICO002 ,
PARAMETROS.GERENTEDIVISAOTEF_QTDFISICO001 ,
PARAMETROS.GERENTEDIVISAOTEF_QTDM2MATE ,
PARAMETROS.GERENTESECAOTEF_QTDFISICOVO002 ,
PARAMETROS.GERENTESECAOTEF_QTDFISICOVO001 ,
PARAMETROS.GERENTESECAOTEF_QTDM2MATE ,
PARAMETROS.GOVERNO_FATORMULTIPLOFATURAMEN ,
PARAMETROS.GOVERNO_QTDEMAXIMADIASFATURAAT ,
PARAMETROS.GOVERNO_VALORMAXIMOMULTIPLOFAT ,
PARAMETROS.LIMITETETO ,
PARAMETROS.PARARCONTMESAENVGN ,
PARAMETROS.SLAMESA ,
PARAMETROS.RESETACONTINUASLA ,
PARAMETROS.QTDMAXCHEQUESFUNDO ,
PARAMETROS.QTDMAXCHEQUESFUNDOSOCIOS ,
PARAMETROS.QTDMAXPENDRESTR ,
PARAMETROS.QTDMAXPENDRESTRSOCIOS ,
PARAMETROS.QTDMAXPROTESTOS ,
PARAMETROS.QTDMAXPROTESTOSSOCIOS ,
PARAMETROS.VLRMAXPENDRESTR ,
PARAMETROS.VLRMAXPENDRESTRSOCIOS ,
PARAMETROS.VLRMAXPROTESTOS ,
PARAMETROS.VLRMAXPROTESTOSSOCIOS ,
PARAMETROS.DIASVENCIMENTOPROPOSTA ,
PARAMETROS.REAPROVEITARDIASVENCIMENTOPROP ,
PARAMETROS.QTDPENDCOMREPROVADO ,
PARAMETROS.ALCADAPADRAO_CAPITALSOCIALATE ,
PARAMETROS.ALCADAPADRAO_CAPITALSOCIALDE ,
PARAMETROS.ALCADAPADRAO_QTDTROCASATE ,
PARAMETROS.ALCADAPADRAO_QTDTROCASDE ,
PARAMETROS.ALCADAPADRAO_QTDVOZAVANCADAATE ,
PARAMETROS.ALCADAPADRAO_QTDVOZAVANCADADE ,
PARAMETROS.ALCADAPADRAO_QTDVSTI_PDTIATE ,
PARAMETROS.ALCADAPADRAO_QTDVSTI_PDTIDE ,
PARAMETROS.ALCADAPADRAO_RISCOATE ,
PARAMETROS.ALCADAPADRAO_RISCODE ,
PARAMETROS.ANALISTACREDEMPATACADO_CAPI002 ,
PARAMETROS.ANALISTACREDEMPATACADO_CAPI001 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDF002 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDF001 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDM2MA ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDM2MD ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDT002 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDT001 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDV004 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDV003 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDV002 ,
PARAMETROS.ANALISTACREDEMPATACADO_QTDV001 ,
PARAMETROS.ANALISTACREDEMPATACADO_RISCOAT ,
PARAMETROS.ANALISTACREDEMPATACADO_RISCODE ,
PARAMETROS.ANALISTACREDEMPATACADO_VALORAT ,
PARAMETROS.ANALISTACREDEMPATACADO_VALORDE ,
PARAMETROS.ANALISTACREDGOVERNO_CAPITAL002 ,
PARAMETROS.ANALISTACREDGOVERNO_CAPITAL001 ,
PARAMETROS.ANALISTACREDGOVERNO_QTDFISI002 ,
PARAMETROS.ANALISTACREDGOVERNO_QTDFISI001 ,
PARAMETROS.ANALISTACREDGOVERNO_QTDM2MATE ,
PARAMETROS.ANALISTACREDGOVERNO_QTDM2MDE ,
PARAMETROS.ANALISTACREDGOVERNO_QTDTROCASA ,
PARAMETROS.ANALISTACREDGOVERNO_QTDTROCASD ,
PARAMETROS.ANALISTACREDGOVERNO_QTDVOZA002 ,
PARAMETROS.ANALISTACREDGOVERNO_QTDVOZA001 ,
PARAMETROS.ANALISTACREDGOVERNO_QTDVSTI002 ,
PARAMETROS.ANALISTACREDGOVERNO_QTDVSTI001 ,
PARAMETROS.ANALISTACREDGOVERNO_RISCOATE ,
PARAMETROS.ANALISTACREDGOVERNO_RISCODE ,
PARAMETROS.ANALISTACREDGOVERNO_VALORATE ,
PARAMETROS.ANALISTACREDGOVERNO_VALORDE ,
PARAMETROS.ANALISTACREDMASSIVOTOP_CAPI002 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_CAPI001 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDF002 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDF001 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDM2MA ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDM2MD ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDT002 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDT001 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDV004 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDV003 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDV002 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_QTDV001 ,
PARAMETROS.ANALISTACREDMASSIVOTOP_RISCOAT ,
PARAMETROS.ANALISTACREDMASSIVOTOP_RISCODE ,
PARAMETROS.ANALISTACREDMASSIVOTOP_VALORAT ,
PARAMETROS.ANALISTACREDMASSIVOTOP_VALORDE ,
PARAMETROS.COORDENACAOACC_CAPITALSOCIALAT ,
PARAMETROS.COORDENACAOACC_CAPITALSOCIALDE ,
PARAMETROS.COORDENACAOACC_QTDTROCASATE ,
PARAMETROS.COORDENACAOACC_QTDTROCASDE ,
PARAMETROS.COORDENACAOACC_QTDVOZAVANCADAA ,
PARAMETROS.COORDENACAOACC_QTDVOZAVANCADAD ,
PARAMETROS.COORDENACAOACC_QTDVSTI_PDTIATE ,
PARAMETROS.COORDENACAOACC_QTDVSTI_PDTIDE ,
PARAMETROS.COORDENACAOACC_RISCOATE ,
PARAMETROS.COORDENACAOACC_RISCODE ,
PARAMETROS.COORDENACAOTEF_CAPITALSOCIALAT ,
PARAMETROS.COORDENACAOTEF_CAPITALSOCIALDE ,
PARAMETROS.COORDENACAOTEF_QTDTROCASATE ,
PARAMETROS.COORDENACAOTEF_QTDTROCASDE ,
PARAMETROS.COORDENACAOTEF_QTDVOZAVANCADAA ,
PARAMETROS.COORDENACAOTEF_QTDVOZAVANCADAD ,
PARAMETROS.COORDENACAOTEF_QTDVSTI_PDTIATE ,
PARAMETROS.COORDENACAOTEF_QTDVSTI_PDTIDE ,
PARAMETROS.COORDENACAOTEF_RISCOATE ,
PARAMETROS.COORDENACAOTEF_RISCODE ,
PARAMETROS.DIRETOREXECVPTEF_CAPITALSOC002 ,
PARAMETROS.DIRETOREXECVPTEF_CAPITALSOC001 ,
PARAMETROS.DIRETOREXECVPTEF_QTDTROCASATE ,
PARAMETROS.DIRETOREXECVPTEF_QTDTROCASDE ,
PARAMETROS.DIRETOREXECVPTEF_QTDVOZAVAN002 ,
PARAMETROS.DIRETOREXECVPTEF_QTDVOZAVAN001 ,
PARAMETROS.DIRETOREXECVPTEF_QTDVSTI_PDTIA ,
PARAMETROS.DIRETOREXECVPTEF_QTDVSTI_PDTID ,
PARAMETROS.DIRETOREXECVPTEF_RISCOATE ,
PARAMETROS.DIRETOREXECVPTEF_RISCODE ,
PARAMETROS.DIRETORTEF_CAPITALSOCIALATE ,
PARAMETROS.DIRETORTEF_CAPITALSOCIALDE ,
PARAMETROS.DIRETORTEF_QTDTROCASATE ,
PARAMETROS.DIRETORTEF_QTDTROCASDE ,
PARAMETROS.DIRETORTEF_QTDVOZAVANCADAATE ,
PARAMETROS.DIRETORTEF_QTDVOZAVANCADADE ,
PARAMETROS.DIRETORTEF_QTDVSTI_PDTIATE ,
PARAMETROS.DIRETORTEF_QTDVSTI_PDTIDE ,
PARAMETROS.DIRETORTEF_RISCOATE ,
PARAMETROS.DIRETORTEF_RISCODE ,
PARAMETROS.GERENTEACC_CAPITALSOCIALATE ,
PARAMETROS.GERENTEACC_CAPITALSOCIALDE ,
PARAMETROS.GERENTEACC_QTDTROCASATE ,
PARAMETROS.GERENTEACC_QTDTROCASDE ,
PARAMETROS.GERENTEACC_QTDVOZAVANCADAATE ,
PARAMETROS.GERENTEACC_QTDVOZAVANCADADE ,
PARAMETROS.GERENTEACC_QTDVSTI_PDTIATE ,
PARAMETROS.GERENTEACC_QTDVSTI_PDTIDE ,
PARAMETROS.GERENTEACC_RISCOATE ,
PARAMETROS.GERENTEACC_RISCODE ,
PARAMETROS.GERENTEDIVISAOTEF_CAPITALSO002 ,
PARAMETROS.GERENTEDIVISAOTEF_CAPITALSO001 ,
PARAMETROS.GERENTEDIVISAOTEF_QTDTROCASATE ,
PARAMETROS.GERENTEDIVISAOTEF_QTDTROCASDE ,
PARAMETROS.GERENTEDIVISAOTEF_QTDVOZAVA002 ,
PARAMETROS.GERENTEDIVISAOTEF_QTDVOZAVA001 ,
PARAMETROS.GERENTEDIVISAOTEF_QTDVSTI_P002 ,
PARAMETROS.GERENTEDIVISAOTEF_QTDVSTI_P001 ,
PARAMETROS.GERENTEDIVISAOTEF_RISCOATE ,
PARAMETROS.GERENTEDIVISAOTEF_RISCODE ,
PARAMETROS.GERENTESECAOTEF_CAPITALSOCIALA ,
PARAMETROS.GERENTESECAOTEF_CAPITALSOCIALD ,
PARAMETROS.GERENTESECAOTEF_QTDTROCASATE ,
PARAMETROS.GERENTESECAOTEF_QTDTROCASDE ,
PARAMETROS.GERENTESECAOTEF_QTDVOZAVANC002 ,
PARAMETROS.GERENTESECAOTEF_QTDVOZAVANC001 ,
PARAMETROS.GERENTESECAOTEF_QTDVSTI_PDTIAT ,
PARAMETROS.GERENTESECAOTEF_QTDVSTI_PDTIDE ,
PARAMETROS.GERENTESECAOTEF_RISCOATE ,
PARAMETROS.GERENTESECAOTEF_RISCODE ,
PARAMETROS.FLAG_CHAMA_ARMARIO ,
PARAMETROS.FLAG_CHAMA_HP_FS ,
PARAMETROS.PERCLIMITEGW ,
PARAMETROS.QTDDIASLOOKUPOVERRIDE ,
PARAMETROS.VLRMAXLIMITEGW ,
PARAMETROS.VLRMINLIMITEGW ,
PARAMETROS.PERCLIMITEGWIAAS ,
PARAMETROS.PERCLIMITEGWSAAS ,
PARAMETROS.VLRMAXLIMITEGWIAAS ,
PARAMETROS.VLRMAXLIMITEGWSAAS ,
PARAMETROS.VLRMINLIMITEGWIAAS ,
PARAMETROS.VLRMINLIMITEGWSAAS from PARAMETROS  INNER JOIN DADOSPROPOSTADS ON  PARAMETROS.IDS_PARAMETROS = DADOSPROPOSTADS.IDS_PARAMETROS  and DADOSPROPOSTADS.NUMPROPOSTA = NUMPROPOSTA `;


/*
`SELECT 'PARAMETROS' TABELA, SYSDATE OPERACAO, SYSDATE DATA_STREAM, PARAMETROS.*
 from PARAMETROS , DADOSPROPOSTADS 
WHERE  PARAMETROS.IDS_PARAMETROS = DADOSPROPOSTADS.IDS_PARAMETROS and DADOSPROPOSTADS.NUMPROPOSTA = '000000000521575'`;
**/

async function find(context) {
  let query = baseQuery;
  const binds = {};

  if (context.id) {
    binds.NUMPROPOSTA = context.id;

    query += `\nwhere NUMPROPOSTA = :NUMPROPOSTA`;
  }

  const result = await database.simpleExecute(query, binds);

  return result.rows;
}

module.exports.find = find;
