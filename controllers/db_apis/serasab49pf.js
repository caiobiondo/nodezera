const database = require ('../../services/database');

const baseQuery =

`SELECT 'SERASAB49PF' TABELA, SYSDATE OPERACAO, 
SERASAB49PF.IDS_SERASAB49PF ,
SERASAB49PF.REQUEST_DOCUMENTO ,
SERASAB49PF.REQUEST_FEATURES_CHAVE1 ,
SERASAB49PF.REQUEST_FEATURES_CHAVE2 ,
SERASAB49PF.REQUEST_FEATURES_CHAVE3 ,
SERASAB49PF.REQUEST_FEATURES_CHAVE4 ,
SERASAB49PF.REQUEST_FEATURES_CODIGO1 ,
SERASAB49PF.REQUEST_FEATURES_CODIGO2 ,
SERASAB49PF.REQUEST_FEATURES_CODIGO3 ,
SERASAB49PF.REQUEST_FEATURES_CODIGO4 ,
SERASAB49PF.REQUEST_IDENTIFICACAO_BAIRRO ,
SERASAB49PF.REQUEST_IDENTIFICACAO_CEP ,
SERASAB49PF.REQUEST_IDENTIFICACAO_CIDADE ,
SERASAB49PF.REQUEST_IDENTIFICACAO_COMPLEME ,
SERASAB49PF.REQUEST_IDENTIFICACAO_CPF ,
SERASAB49PF.REQUEST_IDENTIFICACAO_DATANASC ,
SERASAB49PF.REQUEST_IDENTIFICACAO_DDDCML ,
SERASAB49PF.REQUEST_IDENTIFICACAO_DDDRES ,
SERASAB49PF.REQUEST_IDENTIFICACAO_FONECML ,
SERASAB49PF.REQUEST_IDENTIFICACAO_FONERES ,
SERASAB49PF.REQUEST_IDENTIFICACAO_GRAFIA ,
SERASAB49PF.REQUEST_IDENTIFICACAO_LOGRADOU ,
SERASAB49PF.REQUEST_IDENTIFICACAO_NOMEMAE ,
SERASAB49PF.REQUEST_IDENTIFICACAO_NUMERO ,
SERASAB49PF.REQUEST_IDENTIFICACAO_UF ,
SERASAB49PF.REQUEST_OPCOES_COMPROMISSOSPRE ,
SERASAB49PF.REQUEST_OPCOES_DETALHEACAOJUDI ,
SERASAB49PF.REQUEST_OPCOES_DETALHECHEQUESE ,
SERASAB49PF.REQUEST_OPCOES_DETALHECHEQUESU ,
SERASAB49PF.REQUEST_OPCOES_DETALHECONSULTA ,
SERASAB49PF.REQUEST_OPCOES_DETALHEDIVIDAS ,
SERASAB49PF.REQUEST_OPCOES_DETALHEDOCUMENT ,
SERASAB49PF.REQUEST_OPCOES_DETALHEFALENCIA ,
SERASAB49PF.REQUEST_OPCOES_DETALHEGRAFIAS ,
SERASAB49PF.REQUEST_OPCOES_DETALHEPENDENCI ,
SERASAB49PF.REQUEST_OPCOES_DETALHEPROTESTO ,
SERASAB49PF.REQUEST_OPCOES_HISTORICOSCORIN ,
SERASAB49PF.REQUEST_OPCOES_PARTICIPACOESSO ,
SERASAB49PF.REQUEST_OPCOES_PREVISAOPAGAMEN ,
SERASAB49PF.REQUEST_OPCOES_REFERENCIAS ,
SERASAB49PF.REQUEST_OPCOES_RESUMOANOTACOES ,
SERASAB49PF.REQUEST_OPCOES_RESUMOCADASTRAL ,
SERASAB49PF.REQUEST_OPCOES_RESUMOGRAFIAS ,
SERASAB49PF.REQUEST_SEMELHANCA_FUNCAO ,
SERASAB49PF.REQUEST_SEMELHANCA_MAE ,
SERASAB49PF.REQUEST_SEMELHANCA_PERCENTUAL ,
SERASAB49PF.REQUEST_SEMELHANCA_TITULAR ,
SERASAB49PF.REQUEST_TELEFONES_CODIGOCONSUL ,
SERASAB49PF.REQUEST_TELEFONES_DDD1 ,
SERASAB49PF.REQUEST_TELEFONES_DDD2 ,
SERASAB49PF.REQUEST_TELEFONES_DDD3 ,
SERASAB49PF.REQUEST_TELEFONES_DDD4 ,
SERASAB49PF.REQUEST_TELEFONES_TELEFONE1 ,
SERASAB49PF.REQUEST_TELEFONES_TELEFONE2 ,
SERASAB49PF.REQUEST_TELEFONES_TELEFONE3 ,
SERASAB49PF.REQUEST_TELEFONES_TELEFONE4 ,
SERASAB49PF.REQUEST_TIPODOCUMENTO ,
SERASAB49PF.RESPONSE_CHEQUESSEMFUNDO_QUANT ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_1_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_10_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_11_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_12_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_13_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_14_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_15_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_16_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_17_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_18_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_19_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_2_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_20_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_21_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_22_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_23_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_24_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_25_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_26_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_27_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_28_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_29_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_3_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_30_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_31_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_32_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_33_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_34_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_35_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_36_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_37_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_38_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_39_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_4_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_40_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_41_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_42_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_43_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_44_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_45_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_46_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_47_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_48_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_49_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_5_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_50_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_51_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_52_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_53_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_54_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_55_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_56_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_57_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_58_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_59_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_6_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_60_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_61_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_62_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_63_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_64_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_65_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_66_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_67_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_68_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_69_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_7_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_70_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_71_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_72_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_73_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_74_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_75_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_76_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_77_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_78_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_79_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_8_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_80_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_81_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_82_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_83_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_84_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_85_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_86_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_87_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_88_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_89_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_9_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_90_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_91_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_92_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_93_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_94_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_95_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_96_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_97_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_98_ ,
SERASAB49PF.RESPONSE_GRAFIA_GRAFIA_99_ ,
SERASAB49PF.RESPONSE_GRAFIA_QUANTIDADEGRAF ,
SERASAB49PF.RESPONSE_GRAFIA_SEMELHANCAG003 ,
SERASAB49PF.RESPONSE_GRAFIA_SEMELHANCAG004 ,
SERASAB49PF.RESPONSE_GRAFIA_SEMELHANCAG002 ,
SERASAB49PF.RESPONSE_GRAFIA_SEMELHANCAG001 ,
SERASAB49PF.RESPONSE_MENSAGEM_CODIGOMENSAG ,
SERASAB49PF.RESPONSE_MENSAGEM_DESCRICAOMEN ,
SERASAB49PF.RESPONSE_PARTICIPACAOEMPRESAS_ ,
SERASAB49PF.RESPONSE_PENDENCIASFINANCEI002 ,
SERASAB49PF.RESPONSE_PENDENCIASFINANCEI003 ,
SERASAB49PF.RESPONSE_PENDENCIASFINANCEI001 ,
SERASAB49PF.SYS_CREATEDATE ,
SERASAB49PF.RESPONSE_ACOESJUDICIAIS_DATAMA ,
SERASAB49PF.RESPONSE_ACOESJUDICIAIS_DATAME ,
SERASAB49PF.RESPONSE_ACOESJUDICIAIS_DESCRI ,
SERASAB49PF.RESPONSE_ACOESJUDICIAIS_NATURE ,
SERASAB49PF.RESPONSE_ACOESJUDICIAIS_QTDETO ,
SERASAB49PF.RESPONSE_ACOESJUDICIAIS_VALOR ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_BAI ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_CEP ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_CID ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_COM ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_DAT ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_005 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_002 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_001 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_DES ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_EST ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_006 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_004 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_003 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_LOG ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_MUN ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_NOM ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_NUM ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_ORG ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_SEX ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_UF ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_UFE ,
SERASAB49PF.RESPONSE_CHEQUESSEMFUNDO_VL001 ,
SERASAB49PF.RESPONSE_CHEQUESSEMFUNDO_VL002 ,
SERASAB49PF.RESPONSE_COSTUMACIADESUSTAC001 ,
SERASAB49PF.RESPONSE_COSTUMACIADESUSTAC002 ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_DAT ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_DDD ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_DES ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_FON ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_MOT ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_NRO ,
SERASAB49PF.RESPONSE_DOCROUBFUREXTRCLO_TIP ,
SERASAB49PF.RESPONSE_IDENTIFICACAO_CPF ,
SERASAB49PF.RESPONSE_IDENTIFICACAO_DATANAS ,
SERASAB49PF.RESPONSE_IDENTIFICACAO_GRAFIA ,
SERASAB49PF.RESPONSE_IDENTIFICACAO_NOVASIT ,
SERASAB49PF.RESPONSE_IDENTIFICACAO_SITUACA ,
SERASAB49PF.RESPONSE_PARTINSUCESSOEMPR_002 ,
SERASAB49PF.RESPONSE_PARTINSUCESSOEMPR_001 ,
SERASAB49PF.RESPONSE_PARTINSUCESSOEMPR_DES ,
SERASAB49PF.RESPONSE_PARTINSUCESSOEMPR_TOT ,
SERASAB49PF.RESPONSE_PROTESTOS_QTDETOTAL ,
SERASAB49PF.RESPONSE_PROTESTOS_VALOR ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA011 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA012 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTAS_P ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA007 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA008 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA009 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA010 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA002 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA003 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA004 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA005 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA006 ,
SERASAB49PF.RESPONSE_REGISTRODECONSULTA001 ,
SERASAB49PF.RESPONSE_CADASTROSINTETICO_ATU ,
SERASAB49PF.RESPONSE_PENDENCIASFINANCEI005 ,
SERASAB49PF.RESPONSE_PENDENCIASFINANCEI006 ,
SERASAB49PF.RESPONSE_PENDENCIASFINANCEI004 ,
SERASAB49PF.REQUEST_SCOREFRAUDE_CEP ,
SERASAB49PF.REQUEST_SCOREFRAUDE_UF from SERASAB49PF  INNER JOIN DADOSPROPOSTADS ON  SERASAB49PF.IDS_SERASAB49PF = DADOSPROPOSTADS.IDS_SERASAB49PF  and DADOSPROPOSTADS.NUMPROPOSTA = NUMPROPOSTA `;


/*
`SELECT 'SERASAB49PF' TABELA, SYSDATE OPERACAO, SYSDATE DATA_STREAM, SERASAB49PF.* 
from SERASAB49PF , DADOSPROPOSTADS 
WHERE  SERASAB49PF.IDS_SERASAB49PF = DADOSPROPOSTADS.IDS_SERASAB49PF and DADOSPROPOSTADS.NUMPROPOSTA = '000000000521575'`;
**/

async function find(context) {
  let query = baseQuery;
  const binds = {};

  if (context.id) {
    binds.NUMPROPOSTA = context.id;

    query += `\nwhere NUMPROPOSTA = :NUMPROPOSTA`;
  }

  const result = await database.simpleExecute(query, binds);

  return result.rows;
}

module.exports.find = find;
